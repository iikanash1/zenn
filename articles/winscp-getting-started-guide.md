---
title: "WinSCP入門：ファイル転送から公開鍵認証まで"
emoji: "🚀"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["windows", "winscp", "sftp", "ssh"]
published: true
---

## はじめに

WindowsユーザーがLinuxサーバーなどにファイルを転送したい場合、WinSCPは非常に強力なツールです。この記事では、WinSCPの基本的な使い方から、より安全な公開鍵認証の設定方法まで、初心者にも分かりやすく解説します。

## 1. WinSCPとは？

WinSCPは、Windows向けのオープンソースなSFTP/FTPクライアントです。主な機能は以下の通りです。

-   **安全なファイル転送**: SFTP、SCP、FTPSなど、暗号化されたプロトコルをサポート。
-   **直感的なGUI**: ドラッグ＆ドロップで簡単にファイルを操作可能。
-   **ディレクトリ同期**: ローカルとリモートのディレクトリを同期する機能。
-   **スクリプト機能**: 定型的なファイル転送を自動化。
-   **公開鍵認証**: パスワードを使わない、より安全な認証方式に対応。

## 2. インストール

1.  **公式サイトへアクセス**: [WinSCP公式サイト](https://winscp.net/eng/download.php)にアクセスします。
2.  **ダウンロード**: 「Installation package」をクリックしてインストーラーをダウンロードします。
3.  **インストール**: ダウンロードしたインストーラーを実行し、指示に従ってインストールを進めます。「標準的なインストール」を選択すれば問題ありません。

## 3. 基本的な使い方

### サーバーへの接続

1.  WinSCPを起動すると、ログイン画面が表示されます。
2.  以下の情報を入力します。
    -   **ファイルプロトコル**: `SFTP` を選択します（推奨）。
    -   **ホスト名**: 接続したいサーバーのIPアドレスまたはホスト名。
    -   **ポート番号**: `22`（SFTPのデフォルト）。
    -   **ユーザー名**: サーバーのログインユーザー名。
    -   **パスワード**: ユーザーのパスワード。
3.  「保存」をクリックして、この接続設定を保存しておくと、次回から簡単に接続できます。
4.  「ログイン」をクリックしてサーバーに接続します。初回接続時には、サーバーのホストキーをキャッシュに保存するか尋ねられるので、「はい」を選択します。

### 画面の見方と基本操作

接続が成功すると、左右に2つのペインが表示されます。

-   **左ペイン**: ローカルPCのファイルシステム
-   **右ペイン**: リモートサーバーのファイルシステム

ファイルのアップロード・ダウンロードは、ドラッグ＆ドロップで直感的に行えます。

-   **アップロード**: 左ペインから右ペインへファイルをドラッグ＆ドロップ。
-   **ダウンロード**: 右ペインから左ペインへファイルをドラッグ＆ドロップ。

## 4. 便利な機能：ディレクトリ同期

ローカルとリモートで特定のディレクトリの内容を同じ状態に保ちたい場合、同期機能が便利です。

1.  メニューバーの「コマンド」>「同期」を選択します。
2.  同期の方向（ローカル→リモート、リモート→ローカル、両方）や同期モード（同期、ミラー）を選択し、「OK」をクリックします。

## 5. セキュリティ向上：公開鍵認証の設定

パスワード認証の代わりに、より安全な公開鍵認証を設定しましょう。

### Step 1: キーペアの生成

1.  WinSCPのログイン画面で「ツール」>「PuTTYgenを実行」をクリックします。
2.  PuTTY Key Generatorが起動したら、「生成」ボタンをクリックし、マウスをウィンドウ上で動かして乱数を生成します。
3.  キーが生成されたら、以下の操作を行います。
    -   **キーのコメント**: 識別しやすい名前（例: `my-pc-key`）を入力します。
    -   **キーのパスフレーズ**: （任意）キーをさらに保護するためのパスワードです。設定を推奨します。
    -   **公開鍵の保存**: 「公開鍵の保存」ボタンをクリックし、`id_rsa.pub`などの名前で保存します。
    -   **秘密鍵の保存**: 「秘密鍵の保存」ボタンをクリックし、`.ppk`形式で保存します。**このファイルは絶対に他人に渡さないでください。**

### Step 2: サーバーに公開鍵を登録

1.  先ほど保存した公開鍵（`id_rsa.pub`）の中身をテキストエディタで開いてコピーします。
2.  WinSCPでサーバーに（この時点ではパスワード認証で）ログインします。
3.  サーバーのホームディレクトリにある `.ssh` ディレクトリに移動します。（なければ作成してください）
4.  `.ssh` ディレクトリの中にある `authorized_keys` というファイルを開き、コピーした公開鍵を追記して保存します。

### Step 3: WinSCPで公開鍵認証接続

1.  WinSCPのログイン画面に戻り、設定したいセッションを選択します。
2.  「編集」をクリックし、「高度なサイト設定」を開きます。
3.  「SSH」>「認証」を選択します。
4.  「秘密鍵ファイル」の欄で、先ほど保存した秘密鍵（`.ppk`ファイル）を選択します。
5.  「OK」をクリックして設定を保存します。
6.  再度ログインを試みてください。パスワードの代わりに、秘密鍵のパスフレーズ（設定した場合）が求められれば成功です。

![](https://storage.googleapis.com/zenn-user-upload/5ecf4b77b4ae-20250629.png)

## まとめ

WinSCPは、Windowsユーザーにとって必須とも言えるファイル転送ツールです。基本的な使い方に慣れたら、ぜひディレクトリ同期や公開鍵認証などの便利な機能も活用して、安全で効率的なファイル管理を実現してください。

　